# 低代码 可视化平台 调研

> 参考：[云凤蝶可视化搭建的推导与实现 - SEE Conf](https://zhuanlan.zhihu.com/p/101665976)、[云凤蝶可视化搭建的推导与实现](https://zhuanlan.zhihu.com/p/90746742?utm_source=qq)、[云凤蝶中台研发提效实践](https://zhuanlan.zhihu.com/p/78425921)、[云凤蝶如何打造媲美 sketch 的自由画布](https://zhuanlan.zhihu.com/p/92469406)、[云凤蝶自由画布之道：分层模型](https://zhuanlan.zhihu.com/p/97768853)、[从零开始的可视化搭建系统](https://zhuanlan.zhihu.com/p/96180775)

## 组件树

1. 组件的导入与二次拼装能力
    - 如何实现中心化的组件注册与加载体系
    - 如何实现编辑与预览时实时更新
    - 如何控制组件之间的加载顺序
    - 多组件的公共依赖如何去重
    - 如何处理组件的不兼容升级
2. 组件的入参属性定制能力
    - 属性面板如何表达 `antd` 的所有 `props` 类型
    - 如何支撑对属性的扩展能力
        - 对值的类型的扩展能力
            - JS 基本类型
            - 业务类型：`Moment`、`Regexp`、`URL`、`Function`、`Email`、`Image`...
        - 对值的来源的扩展能力
            - 静态值
            - 数据绑定（单向，双向，一次性）
            - 异步动态数据源（HTTP/TR）
            - 第三方图片素材库...
3. 组件的逻辑编排与联动能力
    - 组件之间组合：如何解决不同屏幕尺寸下的多组件位置关系变化问题
        - 编辑时拖拽组件的二维坐标如何形成嵌套 **组件树**
        - 当**屏幕尺寸变化**的时候，组件自身，组件与其他组件之间的位置关系如何变化
    - 组件之间联动：如何支持外置共享状态的管理与消费

## 布局系统

### 自由布局 / 弹性布局

1. 宽度/高度
    - 固定：永远不变
    - 自适应：随着容器（父）的变大和变大
    - 适配内容：随着内容（子）的变大而变大
2. 上下左右间距
    - 固定：永远不变
    - 自适应：随着容器 （父）的变大而变大

整个算法的核心原理：

1. 编辑态用户操作：
    - 自由拖拽：得到 x（水平坐标）、 y（垂直坐标）、 w（宽）、 h（高）
    - 按需配置宽、高、间距的布局约束规则
2. 编译时：
    - 基于直接被包含算法，得到组件树
    - 基于水平垂直轴是否交叉对整个页面递归进行行列分割，将绝对定位的布局系统转换为相对布局
    - 对约束规则进行翻译
3. 运行时
    - 一个普通的自适应页面

### 画布体验

如：参考线、对齐、成组、分布、拖拽、缩放，相对位置 等等。

---

### 区分 no-code、low-code、pro-code

- **no-code**：自己编程给自己用，给用户的感觉就是一个软件。因此，平台不会给自己定位成一个“编程工具”。主要是通过图形化的操作来降低学习曲线，类似PPT、Excel等。在垂直领域的特定场景中，才能做到好用。

- **low-code**：编程给其他人用，通过降低专业难度，让运营人员（CitizenDeveloper）也参与进来。平台评估好预制的场景和需求，减少从头写代码的成本，一定程度上可以通过图形化的方式满足业务诉求。

- **pro-code**：日常软件开发过程中的手写代码，可以通过逻辑和模块复用来进行提效。

区分了概念之后，还需要考虑面向的用户。不同的用户对应着不同的解决方案。用户大致分为三类：前端开发人员、后台开发人员、产品运营人员。

### 低代码应该具备哪些核心能力？

- **基础物料的搭建和接入是保证业务可视化的基础**。无论是行业的开源组件，还是团队自定义的基础组件，搭建平台都应该无缝地进行预期内的接入和控制。这是因为，从业务长期迭代的角度来看，最耗费人力的一定是最频繁的业务组件。解决定制化的组件和接入组件由此成为低代码平台长期需要解决的最核心问题。

- **编排能力就是页面排版和对逻辑编排**。无论是特定场景的页面的组件逻辑，还是用户自定义的交互（包括用户行为的服务端能力支持）都应该通过逻辑编排能力进行支持。大部分的页面搭建工作都是在桌面端完成的，但是页面渲染的产物可能是多种形式的，比如：PCWeb、H5Web、小程序，**那么在搭建运行时的实时可视化和搭建完成的多端适配和多场景适配，这样就解决了跨技术栈和跨端问题**；

- 虽然是low-code的设计方案，但还是希望输出的代码是可以进行二次开发的，**因此最好能pro-code与low-code互相转换**。编程产物分为初级产物、中间产物和最终产物。产物的丰富程度，直接决定了平台的可复用性和灵活性。无论是基于低代码开发和源码的混合开发，还是基于低代码平台的二次开发，都是low-code平台需要考虑的事情。

- **运行时能力也非常重要**，对开发者来说是一个强大的编辑器引擎，可以方便快速接入各类组件和中间件。而对于运营人员（CitizenDeveloper）来说同样也很重要，针对不同的产品和业务场景，需要定制基础业务模版和和业务配置，方便他们快速地进行差异化的功能设计。

- 协作能力和数据分析能力就不言自明了。**低代码平台的核心就是降低对专业性的要求**。因此，使用者无论是谁，都应该有更高的效率提升。而数据统计和分析是所有平台都应该具备的基础能力，这里就不详细描述了。

核心能力如下：基础资料的搭建、基础资料的接入、业务编排能力、界面渲染能力、代码转换能力以及运行时能力、协作能力和数据分析能力。

以上就是我认为的低代码方案应该具备的能力模型
