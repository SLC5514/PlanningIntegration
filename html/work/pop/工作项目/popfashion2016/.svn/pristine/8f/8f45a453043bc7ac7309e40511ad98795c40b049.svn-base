{extends file="layout.html"}

{block name="selfcss"}
	<link rel="stylesheet" type="text/css" href="{STATIC_URL2}/global/css/lists/styles-list/style_list.css?{STATIC_CHANGE_TIME}">
	<link rel="stylesheet" type="text/css" href="{STATIC_URL2}/global/css/pop_layer.css?{STATIC_CHANGE_TIME}">
	<link rel="stylesheet" type="text/css" href="{STATIC_URL2}/global/css/new-detail/style-detail.css?{STATIC_CHANGE_TIME}">
	<link rel="stylesheet" type="text/css" href="{STATIC_URL2}/global/css/lists/common/list-common.css?{STATIC_CHANGE_TIME}">

{/block}
{block name="main"}
<div class="style-list-contain">
	<input type="hidden" id="link"
        data-ds="{if $columnId eq 54 && !$paramsArr.ds}2{else}{$paramsArr.ds}{/if}"
        data-col="{$columnId}"
        data-urlprefix="{$link['urlprefix']}"
        data-sor="{$link['sortRandom']}"
        data-url="{if isset($link['url'])}{$link['url']}{/if}"
        data-param="{if isset($link['param'])}{$link['param']}{/if}"
        data-search="{if isset($link['search'])}{$link['search']}{/if}"
        data-pow="{$memberFlag}"
        data-page="{$page}"
        data-isgroup="{$isGroup}"
        data-limitnum=""
        data-pagesize="{$pageSize}"/>
	<!--头部轮播-->
	<div class="banner-top new-banner-top new-banner">
		{block name="topads"}
            {include file="lists/lists-common/banner_ads.html"}
        {/block}
        <!-- 列表导航 -->
		{include file="lists/lists-common/list_nav_box.html"}
    </div>
	<div id="anchor"></div>
    <div class="select-label-contain js-select-label-contain new-right-nav">
        <!-- 筛选项 -->
        <div class="rightc_top contentW">
            <div>
                {include file="lists/lists-common/style_select.html"}
            </div>
            <div class="js-fixed-select select-scroll-fixed" style="display: none;">
                {include file="lists/lists-common/style_select.html"}
            </div>
            {if $columnId eq 50}
            <div class="js_color_analysis"  style="display: none;">
                <div class="color_analysis"></div>
                <!--<div class="tech_support"><p>颜色识别技术由码隆科技 <img src="{STATIC_URL2}/global/images/p_icon1.png"> 合作提供</p></div>-->
            </div>
            {/if}
            <div class="shaixuan-wid-box">
                <div class="shaixuan_wid js-shaixuan-wid clearfix">
                <div class="category-style-select">
                    <a class="book-select {if $group}cur{/if}" href="{$sLinkGroup}"><em></em>成册</a>
                    <a class="page-select {if !$group}cur{/if}" href="{$sLinkSingle}"><em></em>单张</a>
                </div>

                <!--订货会合辑-->
                {if $columnId eq 52}
                <span class="line-fg"></span>
                <div class="fl ordermeeting-box">
                    <a href="/books/ordermeeting/" class="js-ordermeeting" target="_blank"><i></i>订货会合辑<em style="display: none;" class="js-remind"></em></a>
                </div>
                {/if}
                <!--/订货会合辑-->
                <span class="line-fg"></span>
                {if $columnId eq 54}
                <div class="showall showall_category">
                    <a class="show_style prop {if !isset($paramsArr['ds']) || $paramsArr['ds'] == 2}cur{/if}" data-key="ds" data-val="2">零售市场</a>
                    <a class="show_book prop {if $paramsArr['ds'] == 1}cur{/if}" data-key="ds" data-val="1">批发市场</a>
                    <a class="show_book prop {if $paramsArr['ds'] == 3}cur{/if}" data-key="ds" data-val="3">展会图库</a>
                </div>
                <span class="line-fg"></span>
                {/if}
                <!-- 按浏览量、时间筛选 -->                
                {include file="lists/lists-common/screen_box.html"}
                <div class="fr clearfix js-total-info-section" id="s_result">
                    {if $isGroup==1}
                    <p class="findstyle">共 <a title="0">0</a> 册</p>
                    {else}
                    <p class="findstyle">共 <a title="0">0</a> 款</p>
                    {/if}

                    <div class='btn_page js-page-control'>
                    <a class='leftBtn neiyeList js-prev-page-btn' href='javascript:void(0);'></a>
                    <span class='pageN'>0</span>/<span class='totalN'>0</span>
                    <a class='rightBtn neiyeList js-next-page-btn' href='javascript:void(0);'></a>
                    </div>
                </div>
                </div>
            </div>
        </div>
        
        <!-- 品牌关联 -->
		{if isset($paramsArr['bra']) && $paramsArr['bra'] && $aRelateBrandsInfo}
		<div class="rightc_brand contentW">
            <div class="w_brand">
                <div class="brand_name clearfix">
                    <span class="fl"><i></i>与该品牌关联的主/副线品牌：</span>
                    <div class="fl">
                        {foreach $aRelateBrandsInfo as $val}
                        <a href="/brands/detail/id_{$val['id']}/" target="_blank">{$val['name']}</a>
                        {/foreach}
                    </div>
                </div>
            </div>
		</div>
        {/if}

        <!-- 权限提示条 -->
        {if !empty($memberFlag)}
        <div class="rightc_wraning contentW">
            {include file="lists/lists-common/wraning_box.html"}
        </div>
        {/if}
    </div>
    <div class="style-images-contain js-style-images-contain">
        <!-- 列表内容 -->
		<div class="contentW">
			<div class="js-list-contain" style="position: relative;">
				{if $group}
				<div class="style-book-box style-lists-box js-style-lists-box">
					<ul class="clearfix lazyload">
						{foreach range(1, 8) as $i}
						<li class="js-placeholder-item">
							<a href="javascript:void(0);" ondragstart="return false;" oncontextmenu="return false;">
								<div class="img-div">
									<img src="{STATIC_URL2}/global/images/loading/style165x.jpg" alt="pic">
									<div class="rotate-img-layer"></div>
								</div>
								<div class="style-book-text"><div class="style-book-position"><p></p></div></div>
							</a>
						</li>
						{/foreach}
					</ul>
				</div>
				{else}
				<div class="style-page-box style-lists-box js-style-lists-box">
					<ul class="clearfix js-list-parent">
						{foreach range(1,12) as $i}
						<li class="js-placeholder-item">
							<div class="img-div">
								<a itemprop="url" href="javascript:void(0);" class="pic-item-area js-general-user-status" ondragstart="return false;" oncontextmenu="return false;">
									<img itemprop="thumbnail" src="{STATIC_URL2}/global/images/loading/style210.jpg">
									<div class="color-and-time">
										<p itemprop="release time" class="Dtime"></p>
									</div>
								</a>
							</div>
							<div class="style-page-text">
								<div class="style-page-position">

								</div>
							</div>
						</li>
						{/foreach}
					</ul>
				</div>
				{/if}
				<div class="scroll-load js-scroll-load"><img src="{STATIC_URL1}/global/images/alertloading.gif"></div>
				<div class="rightc_bottom js-page-section contentW"></div>
				<!-- 游客弹层 -->
				<input type="hidden" value="{$showMask}" id="showMask"/>
				{include file='common/list-tourist-layer.html'}
			</div>
        </div>

        <!-- 搜索空数据 -->
        <div class="rightc_main contentW hide js-error-section">
            {include file="lists/lists-common/search_null.html"}
        </div>

        <!-- pop发现 -->
        {if count($bottomAds) > 0}
        <div class="discovery-contain contentW js-discovery-contain">
            <h2><img src="{STATIC_URL1}/global/images/lists/styles-list/dis_tit.jpg"></h2>
            {if $iReportCount > 2}
            <div class="style-selection-box js-style-selection-box clearfix" data-report-link="{$sReportLink}" data-report-count="{$iReportCount}">
                        <ul class="fl">
                            {foreach $aReportList as $report}
                            <li>
                                <a href="/details/report/t_{$report.tableName}-id_{$report.list.id}-col_{$report.columnId}/"
                                target="_blank" title="{$report.list.title}">
                                    <div class="img-div">
                                        <img src="{$report.list.cover}">
                                    </div>
                                    <p>{$report.list.title}</p>
                                    <div class="bolong-column">{$report.sColumn}</div>
                                </a>
                            </li>
                            {/foreach}
                        </ul>
                <div class="selection-more js-selection-more fr">
                <a href="{$sReportLink}" target="_blank">
                    <div class="middle-border">
                    <p><span>更多精选款式分析</span><br/><span>MORE &gt;</span></p>
                    </div>
                </a>
                </div>
            </div>
            {/if}
            <ul class="clearfix">
                {foreach $bottomAds as $ad}
                <li>
                    <a href="{$ad.sLink}" {if $ad.sNewWindow} target="_blank" {/if}>
                        <img src="{$ad.sImagePath}">
                    </a>
                </li>
                {/foreach}
            </ul>
        </div>
        {/if}
    </div>
</div>

{if $P_UserType eq 5}
<!-- 留资 -->
{include file="common/sem_trends.html"}
{/if}

<!-- 权限弹出层 -->
<div class="general-user-info-fixbox js-general-user-info-fixbox">
	<div class="contentW">
		<button title="关闭"></button>
		<h3>想1秒了解该款全部细节？</h3>
		<p>秀场精选、订货会、标杆品牌、独家全球商拍...千万款式，总有您正在找的，立即加入POP查看高清大图，让款式开发更得心应手</p>
		<a class="js-contact-qq-btn" href="javascript:void(0);" title="在线客服">咨询了解VIP，会员体验畅通无阻</a>
		<a href="/member/pagelogin/" title="立即登录">登录/注册 发现免费推荐</a>
		<span>电话咨询 <span>4008-210-500</span></span>
	</div>
</div>
<!-- 保存搜索弹层 -->
<div class="shadow_guide s_index js-shadow-save"></div>
<div class="save-search-layer js-save-search-layer">
	<p class="save-txt">还不知道你是谁，没办法记住你的搜索<br/>快来登录下吧</p>
	<div class="save-btn">
		<a class="cancel-btn js-cancel-btn">取消</a>
		<a class="login-btn js-comfirm-btn" href="javascript:void(0);">登录</a>
		<a class="reg-btn" href="/member/register/">注册</a>
	</div>
</div>
<!-- 详情上下页排序信息 -->
<input type="hidden" value='{$pageTurnList}' id="thisPageTurnList">
<input type="hidden" value="" id="otherPageTurnList">

<input id="encrypt" type="hidden" data-sign="{$sign}" data-timestamp="{$timeStamp}" data-token="{$token}">
<!-- 详情上下页排序信息 -->
<input type="hidden" id="sGender" value="{$sGender}">
<input type="hidden" id="sIndustry" value="{$sIndustry}">
<input type="hidden" id="sColumn" value="{$sColumn}">
{/block}
{block name="other"}
<div id="loadingBg"><div class="noPic"></div></div>
<div class="pop_layer_page pop_layer_page1" id="pop_layer">
{include file="detail_layer_template.html"}
</div>
{/block}
{block name="self"}
<script type="text/javascript" src="{STATIC_URL3}/global/js/common/imagesloaded.pkgd.min.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/global.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/save_search.js?{STATIC_CHANGE_TIME}"></script>
{if !empty($paramsArr.ds)}
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/Column{$columnId}_{$paramsArr.ds}_Brand.js?{$brandStaticTime}"></script>
{else}
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/Column{$columnId}_Brand.js?{$brandStaticTime}"></script>
{/if}

<script type="text/javascript" src="{STATIC_URL3}/global/js/secret/crypto-js/crypto-js.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/secret/jsencrypt.js?{STATIC_CHANGE_TIME}"></script>

<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/util_brand.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/util_label.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/common/template.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/regionFromSolr.js?{$regionStaticTime}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/regionAction.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/util_pop3_pic.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/util.collect.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/styles.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/fashion/modernizr.custom.97074.js?{STATIC_CHANGE_TIME}"></script>

<script type="text/javascript" src="{STATIC_URL3}/global/js/common/echarts.js?{STATIC_CHANGE_TIME}"></script>
<!-- 新增 -->
<script type="text/javascript" src="{STATIC_URL3}/global/js/common/banner-slide.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/lists/list-common.js?{STATIC_CHANGE_TIME}"></script>
<script type="text/javascript" src="{STATIC_URL3}/global/js/lib/laypage/laypage.js?{STATIC_CHANGE_TIME}"></script>
{if $isGroup==1}
<script type="text/javascript" src="{STATIC_URL3}/global/js/lists/style-book-list.js?{STATIC_CHANGE_TIME}"></script>
{else}
<script type="text/javascript" src="{STATIC_URL3}/global/js/lists/style-list.js?{STATIC_CHANGE_TIME}"></script>
{/if}
<script type="text/javascript" src="{STATIC_URL3}/global/js/sem_phone/sem_phone.js?{STATIC_CHANGE_TIME}"></script>

{literal}
<script type="text/javascript">
    $(function () {
        // 异步加载筛选条件
        oPopStyles.loadSelectItems('{/literal}{$columnId}{literal}');
        $(".lazyload img").lazyload({effect: "show"});
    });
</script>
{/literal}
{if $columnId eq 54}
<script type="text/javascript">
	pop_fashion_style_page.is_global_page=true;
</script>
{/if}


{literal}
<script type="text/javascript">
	var aco = "{/literal}{$paramsArr['aco']}{literal}";
	var cat = "{/literal}{$paramsArr['cat']}{literal}";
	var isGroup = !!'{/literal}{$isGroup}{literal}'; // 是否是成册
    $(function(){
        /**
         *
         * @param main DOM对象
         * @param data 饼图数据
         * @param type 参数
         */
        var createPie = function (main, data, type) {

            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(main);
            var _data = data;
            // 指定图表的配置项和数据
			if(aco!="" && type=="aco"){
                var formatter = function(e){
					return e.data.sColorNumber;
				}
			}else if(cat!="" && type=="cat"){
				var formatter = "{c}";
			}else{
                var formatter=function(){
                    return "";
                }
			}
            var option = {
                tooltip: {
                    trigger: 'item',
                    formatter: formatter
                },
                series: [
                    {
                        name: '色彩分析',
                        type: 'pie',
                        radius: ['0%', '60%'],
                        data: _data,
                        label: {
                            normal: {
                                formatter: '{b} {d}%'
                            }
                        },
                        labelLine: {
                            normal: {
                                length: 10,
                                length2: 30
                            }
                        },
                        itemStyle: {
                            normal: {
                                shadowBlur: 5,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.2)'
                            }
                        }
                    }
                ]
            };
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);

            myChart.on('click', function (d) {
                var self = $(this);
                var param = global_param;
                if (!oCommon.clickBeforeFlicker(self)) {
                    return ;
                }

                param = oPopStyles.dealParam(param, type, d.data.id);
                var disNum = param.split('dis_')[1];
    			disNum = parseFloat(disNum) || 1;
    			console.log(disNum);
                var re = /dis\_[0-9]{1,}/;
		        if(param.indexOf('dis_')==-1){
		        	param = global_search ? param.replace(/\/$/,'')+'-dis_1/'+global_search : param+'-dis_1/';
		        }else{
	        		param = global_search ? param.replace(/\/$/,'')+'/'+global_search : param+'/';
			        param = param.replace(re, 'dis_'+disNum);
		        }
                location.href = global_url+param.replace(/^\//,'')+'#anchor';
            });
        };

        var getPiePic = function () {

            var params = global_param;
            var key = oPopStyles.GetQueryString('key');
            var refresh = oPopStyles.GetQueryString('refresh');
            var url = '/styles/getPieData/' + '?' + Math.random();
            var col = link.data('col');
            if (col == 50) {
                $.ajax({
                    type: 'post',
                    url: url,
                    data: {col:col, params:params, key:key,refresh:refresh},
                    dataType: 'json',
                    beforeSend: function(){
                        var html = '<img class="pie_loading" src="/global/images/loading_pie.gif"/>';
                        $(".color_analysis").html(html);
                        return true;
                    },
                    success: function(data) {
                        var colorTag = data.colorBack ? '<a href="' + data.colorBack + '"><img src="/global/images/returnBack.png" alt="返回"></a>' : '<img alt="显示图表" src="/global/images/colorAnalysis.png"/>';
                        var categoryTag = data.categoryBack ? '<a href="' + data.categoryBack + '"><img src="/global/images/returnBack.png" alt="返回"></a>' : '<img alt="显示图表" src="/global/images/singleGuide.png"/>';
                        var html = '';
                        html += '<div class="pie"><div class="analysis_pic js-analysis-pic1">' + colorTag + '</div><div class="color" id="main_color"></div></div>';
                        html += '<div class="pie"><div class="analysis_pic js-analysis-pic2">' + categoryTag + '</div><div class="category" id="main_category"></div></div>';
                        $(".color_analysis").html(html);

                        createPie(document.getElementById('main_color'), $.parseJSON(data.analysis), 'aco'); //色彩分析
                        createPie(document.getElementById('main_category'), $.parseJSON(data.category), 'cat'); //单品指南
                    }
                });
            }
        };

        var is_exsist = $.cookie("is_exsist") || '';
        var is_down = true, is_click = false;
        var picSrc = $(".js_analysis_show");
        var select_box = $(".js-selected-box");
        if (picSrc != undefined ) {
            if(is_exsist != ""){      
                is_down = true;
                $('.js_color_analysis').show();
                getPiePic();
                picSrc.removeClass("show-up").find(".js_is_show>span").text('收起数据分析图表');
                select_box.css({'padding-bottom':'0px'});
            }else {                  
                is_down = false;
                picSrc.addClass("show-up").find(".js_is_show>span").text('展开数据分析图表');              
            }

            $(".js_analysis_show").on('click',function(){
                if (!is_click && is_exsist == "") {
                    getPiePic();
                }
                is_click = true;
                if(!is_down){ //下拉状态
                    picSrc.removeClass("show-up").find(".js_is_show>span").text('收起数据分析图表');
                    select_box.animate({'padding-bottom':'0px'},500);
                    $('.js_color_analysis').slideDown(500,function(){
                        $.cookie("is_exsist", 20, {expires:365, path:'/', domain:'.pop-fashion.com'});                        
                        is_down=true;

                    });
                }else{
                    picSrc.addClass("show-up").find(".js_is_show>span").text('展开数据分析图表');
                    $('.js_color_analysis').slideUp(500,function(){
                        $.cookie("is_exsist", null, {path:'/', domain:'.pop-fashion.com'});
                        is_down=false;
                    });
                }
            });
        }

        var resize_first=false;		//记录是否操作过

        // 饼图显示按钮
        $(".js_is_show").on('mouseenter mouseleave', function(e){
            if(e.type=='mouseenter'){
                $(this).parent().addClass("show-up-hover");
            }else{
                $(this).parent().removeClass("show-up-hover");
            }
        });

        $(window).resize(function(){
        	if($('.analysis_pic').length<=0||resize_first===true||$('.js_color_analysis canvas').length<=0){
        		return;
        	}
        	resize_first=true;		//已经操作过
        	var contain_w=$('.js_color_analysis canvas').innerWidth()/2;
	    	var left1=contain_w;
	    	var left2=contain_w;
	    	$('.analysis_pic').eq(0).css({			//改为left定位
	    		    left: (left1)+'px'
	    	})
	    	$('.analysis_pic').eq(1).css({
	    		    left: (left2)+'px'
	    	})
        })

    });
</script>
<script>         
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?"":e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)d[e(c)]=k[c]||e(c);k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1;};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p;}('8 B(2,b){D(C 2==\'x\'){2=w.n(2)}3 a=1.o.7(2,1.4.5.c(b),{r:1.4.5.c(\'e\')});9 1.4.s.n(a.y)};8 z(2,b){3 q=1.o.6(2,1.4.5.c(b),{r:1.4.5.c(\'e\')});9 q.A(1.4.5)};8 u(a){3 6=h d();6.t(v());p=6.6(R(a));9 p};8 T(m){3 7=h d();7.U(0());3 k=7.7(m);i=S(k).Q(/\\+/g,\'%X\');9 i};8 0(){3 0=\'-----Y l j-----\';0+=\'V+f+W\';0+=\'P\';0+=\'H+I\';0+=\'G\';0+=\'E/F/J\';0+=\'N/O+M\';0+=\'K\';0+=\'-----L l j-----\';9 0};',61,61,'pub_key|CryptoJS|plainText|var|enc|Utf8|decrypt|encrypt|function|return|encrypted|AES_KEY|parse|JSEncrypt|1234567887654301|||new|data_str|KEY|res|PUBLIC|str|stringify|AES|data_decrypted|decrypted|iv|Base64|setPrivateKey|rsa_decrypt|pri_key|JSON|object|ciphertext|aes_decrypt|toString|aes_encrypt|typeof|if|Avw5eS3UkIPixj4B0mZkhn9VZ9mOgBRgs9Lo|Ihc|GHGXr73iXRhLgqfQhC5dlMisbr3GqnGtPNVOBDYGtGgKS4mpaYzpO60kunooKmdH|3PSU5jrzuzDUEqZvEQaOHfKcUXRx3C61iR9iTnA6YCZLlIX3CnRJzYWCJNRjV|qp|hJXAk3kZvzQjIpzKrYAqHYp|hwIDAQAB|END|EfjuWjJxz02MuWsi|4cKyAfWCegA0G0fGo2aJWqpFrAg25FTDXFf0DRDz|AIEvJu|rcEaJOO94OSQsWzIQSGWM4yoVOVg85YKhW5JlwAHH53Zd8sASLk0ypQv5ze68zeS|replace|decodeURIComponent|encodeURI|rsa_encrypt|setPublicKey|MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1053Mcqn6WH|liJid6|2B|BEGIN'.split('|'),0,{}))
</script>
{/literal}
{/block}


