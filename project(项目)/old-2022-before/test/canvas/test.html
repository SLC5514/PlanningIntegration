<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    * {
      overflow: hidden;
      margin: 0;
      width: 100%;
      height: 100%;
    }

    .c {
      /* background: black; */
    }
  </style>
</head>

<body>
  <canvas class="c">HTML5 Canvas彩虹波动动画特效</canvas>
</body>
<script>
  var c = document.querySelector('.c') /* canvas element */,
    w /* canvas width */, h /* canvas height */,
    ctx = c.getContext('2d') /* canvas context */,

    /* previous & current coordinates */
    x0, y0, x, y,
    t = 0,
    t_step = 1 / 50,
    tmp,

    /* just me being lazy */
    exp = Math.exp,
    pow = Math.pow,
    sqrt = Math.sqrt,
    PI = Math.PI,
    sin = Math.sin,
    cos = Math.cos;


  /* FUNCTIONS */
  /* a random number between min & max */
  var rand = function (max, min) {
    var b = (max === 0 || max) ? max : 1,
      a = min || 0;

    return a + (b - a) * Math.random();
  };

  var trimUnit = function (input_str, unit) {
    return parseInt(input_str.split(unit)[0], 10);
  };

  var initCanvas = function () {
    var s = getComputedStyle(c);

    w = c.width = trimUnit(s.width, 'px');
    h = c.height = trimUnit(s.height, 'px');
  };

  var wave = function () {
    x0 = -1, y0 = h / 1;

    ctx.clearRect(0, 0, w, h);

    tmp = pow(t, 1) / 1; /* keep computation out of loop */

    for (x = 0; x < w; x = x + 3) {
      y = 
        2 * sqrt(x) * sin(x / 200 / PI + t / 20 + sin(x / 200 + t))
        +
        10 * sin(t) * cos(x / 50 + t / 7)
        +
        50 * cos(t) * sin(sqrt(x) + rand(1, 1) * tmp) + h / 2;

      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x, y);
      ctx.lineWidth = 1;
      // ctx.strokeStyle = 'hsl(' + (2 * x / w + t) * 180 + ', 100%, 65%)';
      ctx.stroke();

      x0 = x;
      y0 = y;
    }



    t += t_step;

    requestAnimationFrame(wave);
  };


  /* START THE MADNESS */
  setTimeout(function () {
    initCanvas();
    wave();

    /* fix looks on resize */
    addEventListener('resize', initCanvas, false);
  }, 15);
</script>

</html>